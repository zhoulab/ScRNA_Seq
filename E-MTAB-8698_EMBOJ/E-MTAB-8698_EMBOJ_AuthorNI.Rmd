---
title: "E-MTAB-8698_EMBOJ_AuthorNI"
output: html_notebook
---
#refer to:
Cattenoz PB, Sakr R, Pavlidaki A, Delaporte C, Riba A, Molina N, Hariharan N, Mukherjee T, Giangrande A. Temporal specificity and heterogeneity of Drosophila immune cells. EMBO J. 2020 Jun 17;39(12):e104486. doi: 10.15252/embj.2020104486. Epub 2020 Mar 12. PMID: 32162708; PMCID: PMC7298292.

#Objectives:
## 1. explore in which hemocyte clusters are III markers expressed.
## 2. determine if III markers are differentially expressed in certain clusters than others
## 3. TBA

#Important files***:
## 1. E-MTAB-8698.sdrf.txt meta information for seurat object
## 2. filtered_feature_bc_matrix_NI_RRCZ22, unzipped folder that contains control (Non_Infected) group of hemocytes scRNAseq data
*** These files can be downloaded at https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E%E2%80%90MTAB%E2%80%908698



set wk dir and library package
```{r}
setwd(getwd())

library(Seurat)
library(ggplot2)
library(cowplot)
library(Matrix)
library(dplyr)
library(ggsci)
library(data.table)
library(tidyverse)
library(patchwork)
library(clustree)
library(remotes)
```

#import seurat data and author's annotation
```{r}

Author_annotation <- data.table::fread(
  "./NI_cell_cluster_ID.txt"
  )

Author_annotation <- as.data.frame(Author_annotation)

NI <- Seurat::Read10X("./filtered_feature_bc_matrix/")

```

#create seurat OBJ
```{r}

NI <- CreateSeuratObject(counts = NI,
                           project = "Non_Infected_RRCZ22", 
                           min.cells = 0,  
                           min.features = 0)
```

#first check if author's annotation is the same as meta.data slot in SOBJ
```{r}
View(NI@meta.data)

#substr rownames to change barcode and match that in Author_annotation
rownames(NI@meta.data) <- substr(rownames(NI@meta.data),1,16)

rownames(NI@meta.data)

#check if author's annotation has the same number of cells as meta.data slot in SOBJ
nrow(NI@meta.data)
#7606
nrow(Author_annotation)
#7517

#they are not the same
```

#subset SOBJ to match author's annotation
```{r}
subset(NI,NI@meta.data$nCount_RNA>1000)




```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

